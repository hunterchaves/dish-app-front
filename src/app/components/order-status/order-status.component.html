<h2>Acompanhe seu Pedido</h2>

<div *ngIf="order$ | async as order; else loadingOrNotFound">
  <div class="order-status-container">
    <h3>Pedido #{{ order.id.substring(0, 7) }}</h3>

    <div class="status-tracker">
      <div class="status-step" [ngClass]="{'completed': order.status === 'Pendente' || order.status === 'Em Preparo' || order.status === 'Saiu para Entrega' || order.status === 'Entregue'}">Pendente</div>
      <div class="status-step" [ngClass]="{'completed': order.status === 'Em Preparo' || order.status === 'Saiu para Entrega' || order.status === 'Entregue'}">Em Preparo</div>
      <div class="status-step" [ngClass]="{'completed': order.status === 'Saiu para Entrega' || order.status === 'Entregue'}">Saiu para Entrega</div>
      <div class="status-step" [ngClass]="{'completed': order.status === 'Entregue'}">Entregue</div>
    </div>

    <div class="current-status">
      Status atual: <strong>{{ order.status }}</strong>
      <p *ngIf="order.status === 'Entregue'" class="delivered-message">Seu pedido foi entregue. Bom apetite!</p>
    </div>

    <div class="order-summary">
      <h4>Resumo do Pedido</h4>
      <div *ngFor="let item of order.items" class="order-item">
        <span>{{ item.quantity }}x {{ item.dish.name }}</span>
        <span>{{ (item.dish.price * item.quantity) | currency:'BRL' }}</span>
      </div>
      <div class="order-total">
        <strong>Total: {{ order.total | currency:'BRL' }}</strong>
      </div>
    </div>

    <a routerLink="/" class="new-order-link">Fazer novo pedido</a>
  </div>
</div>

<ng-template #loadingOrNotFound>
  <p>Carregando pedido ou pedido n√£o encontrado...</p>
</ng-template>
